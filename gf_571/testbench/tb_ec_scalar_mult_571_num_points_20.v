`timescale 1ns / 1ps
//////////////////////////////////////////////////////////////////////////////////
// Auto-generated Testbench for EC Scalar Multiplication GF(2^571)
// Curve: sect571r1
//////////////////////////////////////////////////////////////////////////////////

module tb_ec_scalar_mult_571;

  reg clk, rst, start;
  reg  [570:0] k;
  reg  [570:0] Px, Py;
  wire [570:0] X, Y;
  wire done;

  // Instantiate DUT
  ec_scalar_mult_571 DUT (
    .clk(clk), .rst(rst), .start(start),
    .k(k), .Px(Px), .Py(Py),
    .X(X), .Y(Y), .done(done)
  );

  // Clock
  always #5 clk = ~clk;

  reg [570:0] test_k [0:19];
  reg [570:0] exp_x  [0:19];
  reg [570:0] exp_y  [0:19];
  integer i;

  initial begin
    clk   = 0;
    rst   = 1;
    start = 0;
    #20; rst = 0;

    test_k[0] = 571'h1;
    exp_x[0]  = 571'h303001d34b856296c16c0d40d3cd7750a93d1d2955fa80aa5f40fc8db7b2abdbde53950f4c0d293cdd711a35b67fb1499ae60038614f1394abfa3b4c850d927e1e7769c8eec2d19;
    exp_y[0]  = 571'h37bf27342da639b6dccfffeb73d69d78c6c27a6009cbbca1980f8533921e8a684423e43bab08a576291af8f461bb2a8b3531d2f0485c19b16e2f1516e23dd3c1a4827af1b8ac15b;
    test_k[1] = 571'h2;
    exp_x[1]  = 571'h1f8bd0b0c77369f3c5a1943c01215cad8c7018c4af1a588e6efe81c0a39e0a50db8e55bb371d956b15dbcb13ab12af532b1fc6b7ddf0a13d12dfaa76051132b84020bec72d2f265;
    exp_y[1]  = 571'h44a9e41f77686550649d5d124021aa477516211625bed15762a0729a0d052c71e99cdcdde7d245c0ab279cd4fd5b554d1f5f5e4ca912c0051df85de732dbc5f672c49f12215103f;
    test_k[2] = 571'h3;
    exp_x[2]  = 571'h72d033e612ca6dd14c28f1f6689af9a97bba7fd88a25bae969dd1c91e75a9f680442dea747eab06e73b746911780505dab0e03149de396b1020fbaf55580cf4d6eb9738ce0d26f8;
    exp_y[2]  = 571'h494ba50070ca0fc97e89f3ea55de5aed4d5bd139b3725618dfeb90152230aa53fa37b6e39baad54a77771f0df01bffee82fbb0bad45f2d5c89f704c6eba6722b1e4433638d87dda;
    test_k[3] = 571'h5;
    exp_x[3]  = 571'h77aac79dc0d8891f8c383a000b6457a6e29adb61b6aa83c32f3815f4d0173085599a42d9dd5529022eedaa849397809b8ce613cd800e1676559ad2dab43338e7e10c1c768c8d209;
    exp_y[3]  = 571'h131f402bf46187d38270bbea69ac9673a66116e11dd7a08fbc222bf513871a7d58798fc0ea22336961c76beb380a7299904dbfd62c1d534d232d6df42795efa601152d2b57c5a7e;
    test_k[4] = 571'ha;
    exp_x[4]  = 571'h2e7f80713d6620dfd571ef392e231940fddf15da67ad31fce4808d4c54f955a566bfc1e8a10e481cf0ec353560a7997d1b562b518585d6db8ec99131a9209d6126a5b6fc54be8fd;
    exp_y[4]  = 571'h95b4a8879821ff2b54f9b3ed927dd3a04db637aa5cd40c727c6ede3030e07b1b7aca812118bf9f377ca98a1336cdf6b83a7122baa1bee70ac221948fa5e54674a072af86025952;
    test_k[5] = 571'h78;
    exp_x[5]  = 571'h7d4b363f72b0034a8563c4eb912ecee4298dae460631aafa32811a076006ba0d4de508c0b5ef2ebd4df22eb8b355cc39b916debaeaef9bdbfa8c0ca61165e9aec9030b41147b9d6;
    exp_y[5]  = 571'h70b40e94660bd392681efc088f43189a089282b5dcecefc9a7287327c1063c7e3b8d81b5dd44d76f5107f45486e5aabe25549e0307518b2327519a44140adfd5413eafb4653c20a;
    test_k[6] = 571'hff;
    exp_x[6]  = 571'h2adced85f84140c94872949ee69bb663e1ccca1431903e1193fbedc8f66ee0fe390d5c5dea7389364ee676e38947065ecbfea1b31f186015ea31044de2ca79c86de70b12f9e7f60;
    exp_y[6]  = 571'h7828a716ed75ce5540571224640b38d90fd03f187762be4a5dd1f089cb34c9ec1bff27a8432590a0d89808dd33a19d04a554800acf310c88725c1b4cdd9a1513664e06cb99e18c6;
    test_k[7] = 571'h40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000;
    exp_x[7]  = 571'h6d1f4c4b82ce435345223934e912b35fd9f33266a7be7b95970aabe6ca57e87082b77b762a1732d68ca09cac496395d95a4d0c426b08b3901ef1e878ea6e6d009e12a14c1bc7f9c;
    exp_y[7]  = 571'h5d6b51b3dc41dbdefb9c37fadf5760bb67ed052cd9560892bf1a3efc4b9f2cc0027f7699694c363789d2cd16b7a6fa875aa42b9b23980aaa28ccf312025ace274188eab3fdfbe88;
    test_k[8] = 571'h7ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff;
    exp_x[8]  = 571'h7e76f3d6ec20f55be67bf8eb23d3913b0c49e9c1dd8b484669dfa69749a61822561dba52135575b79c5b0972879d6181c5e736d1f72d0338ef2459949b13152c20ac0c0b248470f;
    exp_y[8]  = 571'h7d82cecbcbb1e6f2bdea2ebde71b8820a920341937ec76b8b00458690041e94dc4ad23ce7acf1af7fdd1901888727055ed644ef4dd77147bc2781ab4684db4d35e47081e3f628b;
    test_k[9] = 571'h1ad6cdbf80e1b7fa0ed8df4f9767d2a14bcd85cc55d5e0c6be17278f10d01a0eadea5ad63c892e83cfad117297c1586e48bc78496c1829f49f75194ed9cf0cd1bca36f9c2ddb12e;
    exp_x[9]  = 571'h6ffece3a2065433f7ae812258f5b0d7e4a4d2503c2329b622e6828fbeeee61bb9cfe155a2bec01e21ecf5032f3fdc100dcd5a82024a2683d2b4514337fceda35acdbf689d5965fb;
    exp_y[9]  = 571'h28e4b8b7c493699c526910b14e262d0786b9c6fb88aa6f11607e5991db655a20439f076d73b3ae9ea157e94091e90599b54ad2c5fdcf7729606335a04539c24e3fbb3ac5842e4a7;
    test_k[10] = 571'h3ab1901643272262f7e6ec6f7f786092cc369b884000ec06d19e7753f4d9526b03b6f3e5080bc521d9b55daf4d95d80023d26a7f6e5e656d73023dc7e65a2f163a098a8df2bd48a;
    exp_x[10]  = 571'h4d3b523cc16d786e7cf7e3ed889adedce6a4f2315310b33988ec1dcffe557869d48bd89bc887677f0e80e5c3e96e3a98093572b8f190f0bbc898182a9bc20b5c81e1b7bbe93e448;
    exp_y[10]  = 571'h60606043fa4c3caad819af4cb2d8277ee9ea581ff1e67d03acc6bf257f8c3d9c08a08f2172efbcf30883e3c9d64ad4bfdde02d6db3a172857847248fba336ea89463464c1bd95ab;
    test_k[11] = 571'h19153ff3936b97811ca7de907fc9118d8a22cd3fe3d5bbb521cf44b3a2528dc708bf0f5d127f3003af140f49801ccb3aefd2a782555d243568d944120a4a6f96b6f452f1cb21d1e;
    exp_x[11]  = 571'h7f431c7ab3571c0fb5a38882de1ba4e706ff0d30ee87be95ca47e544c53c86eb0328e9ee9601bf8b7baf589317251e18599c2f7842dce2c5b271baca55622773640cff153b5d02e;
    exp_y[11]  = 571'h39c9a8f3f6d061fe4ac013fff80815edc82f323db5936451491bd991b0b2e946f18dd7c9416e8c09c3a90292c660b55d37187ef75aabd7ff3ec4e32c13a12979066c44b47aad32f;
    test_k[12] = 571'h5ee39593d7c9f3efdcb782ea82530846d4b6da7ea1c8b9503a864983f619a7913c9c0a1beef72b70a8dec71b401ed81f73bcb5db27247b9359dccce340c0563ab116f7b47cf4429;
    exp_x[12]  = 571'ha01590ac03a6b91428b6faca8d364068a2e566956f9842cdadf772be4c886eb2f345fdbb57a5a4c09c893e30837a6000bc0b16418f9e4fe804e1bd50239e3c39b9b01107662a6b;
    exp_y[12]  = 571'hb57b7d5030b45434f3174d361166447b4e36c69fa318472cdcec6c227d42bd873e542bf878cab1226cb9f7c8260b0d2f2337b6e6353a1e7334e544d2d85bc94064d14809dc207c;
    test_k[13] = 571'h1ce70c154cc0bb83c15f9a91e2adb39f84f8d4346c6b91f7b180d1c55d56178a9436ce8155dcc3dd330c71bebd74f13529ce75ca5ea8af03994d07298a120848a6ec42cc3aa2315;
    exp_x[13]  = 571'h50c9ad7ae6281838764c5009bd7f8c52359f5850edfddb6b9681f0b1beaf47d0017912710dc90f58717860e8503a29f58a72f2707d27651f32a1a3d357401cc73073a80c2bb2fb5;
    exp_y[13]  = 571'h10aba588f8ca4b7aab9bc12776263ce458ea8cf66a3d16bd8e031890d29c9f8dce7b17be0b54a995191f5b6386634ccf05e816c99eaa4d9361abaaafc9385dc00670178d6997f70;
    test_k[14] = 571'h7e918426e88655257ea32c80004308e7597226f0bc19db545b94ac89f89f492c4046fed689ec53fbabf0acb484e6828375b999dc572eff0d2cb8a1b4649fc93a5e99f3cf2ff446;
    exp_x[14]  = 571'h57774854f4f4a6efc206edecceb2118e567efcbb7dafbe9baa5b733e36aa4f3f43f7b3f89fd8ef101e0f611789a8eca92057c4977920e70597145ce5a586c95cba4979e22576954;
    exp_y[14]  = 571'h2f87ba344cbfe31a79bf3c3f5ab1627252edd8aeb0a9f42fa950f442a5ccf5272f3b53d3318bd5075e11c880f39301300fdf8dd5968ae76c84be5d41656ac9ef7bab70ee4595fc7;
    test_k[15] = 571'h41177c09a94fc6f5d631f66b90d886865aee7d738f35c1aa55fb1fd4cca58466cd5b61802314f0e274a66f8563ed9da730ecb31367b59a0c4ddb8f03ad92df5b638d9654bd43c14;
    exp_x[15]  = 571'h3584143b92281086dc477025e2f8aef6150e22ff9f658d547ad511cb416df3e08669640d822d208ea6f6cafb65a4f2f2de4b358d5d5e80e10b8453ab9d1c7652795b76453f0140c;
    exp_y[15]  = 571'hfb13bea237317510afe6d9ba2a4718e7b83e0ffdfa9757bc097447f6e6f9bf60803123f04de1acfc25e82ce2051aaebc0d4a4b34e418b98f3907b66551a93aac554f101b88bf38;
    test_k[16] = 571'h396550818656933d6863acb336e42970dc29379ed6a6a8cd6109b8b6a23d7ba998ba45e3531cfbf71128de16cf727185d01130dd7d8ae3e9c90d4f200ab0b1232feacf45eba3ba0;
    exp_x[16]  = 571'h19ab3a9e229378ec6c1265554d7b2ea408a360a7175458bc0c6f4cef35249bc0b3a315b5de8b0b32dd550c0964a216be288bdadb1219411c2ae701fcf08568dad0944d38901c77c;
    exp_y[16]  = 571'h78d5bdb96e9e69175571d18fb9c57f637d748b50725994ef46db103c46625610a32cba49f345906a5becdbe9037b38647c2fe6805f67ea3efe08fe960715f83415713d689bb9d56;
    test_k[17] = 571'h25712fa6da2adb33135c7ed2c4862b7e820422e2827d4d505d1df89d61d7357dd2b1c342944bd78095f6f67119bbd62e464dc9e5e21cc71d7a4f11e11345df3bf8e2cce42925b57;
    exp_x[17]  = 571'h49497f1bff0a0b4f0fa6c14f478bfcadd04de54b9139b7525ce59dbf734f850c976059c090aab697a41a158b2534dbe33a5a7891b28fc1d75d568081b1bd01cee4183f2b0d33cb;
    exp_y[17]  = 571'h29b88ee2d9ccd265709d3293c4fa0642b46e0f3df4f7d9fd54bae874b59af2c2b2ea8f7111339a4e2f4b6e51e0d583e214c36034a343dce9d310ae86b7f42c791331ad9b99ecdbc;
    test_k[18] = 571'h3cbd2a3ffe7c7505e76eef94f8cf24afecf1eb4684c4800611f498f11ac5b4e0d9eee1ec1e487d5832c846d5fa0369c9060e5894a0db2ea0347fd982ca541d25425f3ee3e5e4d57;
    exp_x[18]  = 571'h6d63bad9aefc8c55dc24a9e2aeb543928795648ba6f510c5922d84077103abb9e22351ca4fa90905e1dea11d9db4a5a335bb9ea396141fa676f0254784cfddc1738e1f2d4b8f36b;
    exp_y[18]  = 571'h556037ecd47ff39e3df77d07e6f6a939368d753346e0dac1ce5829dd31ecb9a0295e20f2ecdae5723ce20705ffc1d7b30ad4d41e51dd95992ffda0ddbc46a6504a71fa8593c5dc2;
    test_k[19] = 571'h561689220f52b9153c891324c6827528acef29e7c8b67eed3840a1d736506c2613c1ecae7a8d980b7cd46757cc4e8f4ba8bcd04c789136de51d4b26d57b3b9b82d384216af94e79;
    exp_x[19]  = 571'h5ac321da737c98b3c203c48e0fcf17a62258cb72d4e9ed29518cc7147e4e3e89c12aae4b2ae2aca5666332e46894c17abf70d30ec5a617479d7cea122d9ac39e211e9d0219caf37;
    exp_y[19]  = 571'h104dd4c1d5e739622a8a46807011ee26a6d02bf9103afc71d457974fb656166b717de53feb32cfbd76a4904186796ff99666a09bbd0da30ca38353b7ed689bd46f6511ae3dfb599;

    for (i=0; i<20; i=i+1) begin
      @(negedge clk);
      k = test_k[i];
	  Px = 571'h303001d34b856296c16c0d40d3cd7750a93d1d2955fa80aa5f40fc8db7b2abdbde53950f4c0d293cdd711a35b67fb1499ae60038614f1394abfa3b4c850d927e1e7769c8eec2d19;
      Py = 571'h37bf27342da639b6dccfffeb73d69d78c6c27a6009cbbca1980f8533921e8a684423e43bab08a576291af8f461bb2a8b3531d2f0485c19b16e2f1516e23dd3c1a4827af1b8ac15b;
      start = 1;
      @(negedge clk); start = 0;
      wait(done);

      if (X !== exp_x[i] || Y !== exp_y[i]) begin
        $display("FAIL: k=%h, got X=%h Y=%h, expected X=%h Y=%h", k, X, Y, exp_x[i], exp_y[i]);
        $stop;
      end else begin
        $display("PASS: k=%h", k);
      end
      #20;
    end
    $display("All scalar multiplication tests PASSED.");
    $finish;
  end
endmodule
